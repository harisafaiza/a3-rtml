# -*- coding: utf-8 -*-
"""dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VySLqDiMDHRrGKtkl0iIELlw2kMOLLVG
"""

import pandas as pd
import os

class SportDataset:
    def __init__(self, csv_file, class_file, root_dir, train=True, transform=None):
        self.data = pd.read_csv(csv_file)
        self.root_dir = root_dir
        self.train = train
        self.transform = transform

        # Load class file safely
        try:
            classes = pd.read_csv(class_file)
        except FileNotFoundError:
            raise FileNotFoundError(f"Class file {class_file} not found!")

        # Ensure that class file has at least 3 columns before processing
        if classes.shape[1] < 3:
            raise ValueError(f"Class file {class_file} must have at least 3 columns, found {classes.shape[1]}.")

        # Fixed indexing issue using `.iloc[]`
        try:
            self.class_dict = {row.iloc[2]: row.iloc[0] for _, row in classes.iterrows()}
        except IndexError:
            raise IndexError("Column index out of bounds. Ensure that the class file has the required structure.")

        print(f"Loaded {len(self.class_dict)} classes successfully.")

    def __len__(self):
        return len(self.data)

    def __getitem__(self, idx):
        if idx not in self.data.index:
            raise KeyError(f"Index {idx} not found in dataset!")

        sample = self.data.iloc[idx]
        if self.transform:
            sample = self.transform(sample)

        return sample